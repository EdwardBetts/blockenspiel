<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Blockenspiel::DSLSetupMethods - Blockenspiel 0.5.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-dsl_attr_accessor">#dsl_attr_accessor</a>
    
    <li ><a href="#method-i-dsl_attr_writer">#dsl_attr_writer</a>
    
    <li ><a href="#method-i-dsl_method">#dsl_method</a>
    
    <li ><a href="#method-i-dsl_methods">#dsl_methods</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Blockenspiel::DSLSetupMethods">
  <h1 id="module-Blockenspiel::DSLSetupMethods" class="module">
    module Blockenspiel::DSLSetupMethods
  </h1>

  <section class="description">
    
<h3 id="module-Blockenspiel::DSLSetupMethods-label-DSL+setup+methods"><a href="DSL.html">DSL</a> setup methods<span><a href="#module-Blockenspiel::DSLSetupMethods-label-DSL+setup+methods">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>These class methods are available after you have included the <a
href="DSL.html">Blockenspiel::DSL</a> module.</p>

<p>By default, a class that has <a href="DSL.html">DSL</a> capability will
automatically make all public methods available to parameterless blocks,
except for the <code>initialize</code> method, any methods whose names
begin with an underscore, and any methods whose names end with an equals
sign.</p>

<p>If you want to change this behavior, use the directives defined here to
control exactly which methods are available to parameterless blocks.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-dsl_attr_accessor" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dsl_attr_accessor</span><span
            class="method-args">(*names_)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A DSL-friendly attr_accessor.</p>

<p>This creates the usual “name” and “name=” methods in the current class that
can be used in the usual way. However, its implementation of the “name”
method (the getter) also takes an optional parameter that causes it to
behave as a setter. This is done because the usual setter syntax cannot be
used in a parameterless block, since it is syntactically indistinguishable
from a local variable assignment. The “name” method is exposed as a
dsl_method.</p>

<p>For example:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_attr_accessor</span> :<span class="ruby-identifier">foo</span>
</pre>

<p>enables the following:</p>

<pre class="ruby"><span class="ruby-identifier">my_block</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">param</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">param</span>.<span class="ruby-identifier">foo</span> = <span class="ruby-value">1</span>   <span class="ruby-comment"># Usual setter syntax works</span>
  <span class="ruby-identifier">param</span>.<span class="ruby-identifier">foo</span> <span class="ruby-value">2</span>     <span class="ruby-comment"># Alternate setter syntax also works</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">param</span>.<span class="ruby-identifier">foo</span>  <span class="ruby-comment"># Usual getter syntax still works</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">my_block</span> <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># foo = 1       # Usual setter syntax does NOT work since it</span>
                  <span class="ruby-comment">#   looks like a local variable assignment</span>
  <span class="ruby-identifier">foo</span> <span class="ruby-value">2</span>           <span class="ruby-comment"># Alternate setter syntax does work</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">foo</span>        <span class="ruby-comment"># Usual getter syntax still works</span>
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="dsl_attr_accessor-source">
            <pre><span class="ruby-comment"># File lib/blockenspiel/dsl_setup.rb, line 263</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dsl_attr_accessor</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names_</span>)
  <span class="ruby-identifier">names_</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name_</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">name_</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">String</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">name_</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">Symbol</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-operator">::</span><span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;#{name_.inspect} is not a symbol&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">name_</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^[_a-zA-Z]\w+$/</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-operator">::</span><span class="ruby-constant">NameError</span>, <span class="ruby-node">&quot;invalid attribute name #{name_.inspect}&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">module_eval</span>(<span class="ruby-node">&quot;def #{name_}(value_=::Blockenspiel::NO_VALUE); ::Blockenspiel::NO_VALUE.equal?(value_) ? @#{name_} : @#{name_} = value_; end\n&quot;</span>)
    <span class="ruby-identifier">alias_method</span>(<span class="ruby-node">&quot;#{name_}=&quot;</span>, <span class="ruby-identifier">name_</span>)
    <span class="ruby-identifier">dsl_method</span>(<span class="ruby-identifier">name_</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dsl_attr_writer" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dsl_attr_writer</span><span
            class="method-args">(*names_)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A DSL-friendly attr_writer.</p>

<p>This creates the usual “name=” method in the current class that can be used
in the usual way. However, it also creates the method “name”, which also
functions as a setter (but not a getter). This is done because the usual
setter syntax cannot be used in a parameterless block, since it is
syntactically indistinguishable from a local variable assignment. The
“name” method is exposed as a dsl_method.</p>

<p>For example:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_attr_writer</span> :<span class="ruby-identifier">foo</span>
</pre>

<p>is functionally equivalent to:</p>

<pre class="ruby"><span class="ruby-identifier">attr_writer</span> :<span class="ruby-identifier">foo</span>
<span class="ruby-identifier">alias_method</span> :<span class="ruby-identifier">foo</span>, :<span class="ruby-identifier">foo=</span>
<span class="ruby-identifier">dsl_method</span> :<span class="ruby-identifier">foo</span>
</pre>

<p>which enables the following:</p>

<pre class="ruby"><span class="ruby-identifier">my_block</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">param</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">param</span>.<span class="ruby-identifier">foo</span> = <span class="ruby-value">1</span>   <span class="ruby-comment"># Usual setter syntax works</span>
  <span class="ruby-identifier">param</span>.<span class="ruby-identifier">foo</span> <span class="ruby-value">2</span>     <span class="ruby-comment"># Alternate setter syntax also works</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">my_block</span> <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># foo = 1       # Usual setter syntax does NOT work since it</span>
                  <span class="ruby-comment">#   looks like a local variable assignment</span>
  <span class="ruby-identifier">foo</span>(<span class="ruby-value">2</span>)          <span class="ruby-comment"># Alternate setter syntax does work</span>
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="dsl_attr_writer-source">
            <pre><span class="ruby-comment"># File lib/blockenspiel/dsl_setup.rb, line 309</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dsl_attr_writer</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names_</span>)
  <span class="ruby-identifier">names_</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name_</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">attr_writer</span>(<span class="ruby-identifier">name_</span>)
    <span class="ruby-identifier">alias_method</span>(<span class="ruby-identifier">name_</span>, <span class="ruby-node">&quot;#{name_}=&quot;</span>)
    <span class="ruby-identifier">dsl_method</span>(<span class="ruby-identifier">name_</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dsl_method" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dsl_method</span><span
            class="method-args">(name_, delegate_=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Make a particular method available to parameterless <a
href="DSL.html">DSL</a> blocks.</p>

<p>To explicitly make a method available to parameterless blocks:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_method</span> :<span class="ruby-identifier">my_method</span>
</pre>

<p>To explicitly exclude a method from parameterless blocks:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_method</span> :<span class="ruby-identifier">my_method</span>, <span class="ruby-keyword">false</span>
</pre>

<p>To explicitly make a method available to parameterless blocks, but point it
to a method of a different name on the target class:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_method</span> :<span class="ruby-identifier">my_method</span>, :<span class="ruby-identifier">target_class_method</span>
</pre>
          
          

          
          <div class="method-source-code" id="dsl_method-source">
            <pre><span class="ruby-comment"># File lib/blockenspiel/dsl_setup.rb, line 175</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dsl_method</span>(<span class="ruby-identifier">name_</span>, <span class="ruby-identifier">delegate_</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">name_</span> = <span class="ruby-identifier">name_</span>.<span class="ruby-identifier">to_sym</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">delegate_</span>
    <span class="ruby-identifier">delegate_</span> = <span class="ruby-identifier">delegate_</span>.<span class="ruby-identifier">to_sym</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">delegate_</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">delegate_</span> = <span class="ruby-identifier">name_</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_blockenspiel_methods</span>[<span class="ruby-identifier">name_</span>] = <span class="ruby-identifier">delegate_</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@_blockenspiel_module</span>.<span class="ruby-identifier">public_method_defined?</span>(<span class="ruby-identifier">name_</span>)
    <span class="ruby-ivar">@_blockenspiel_module</span>.<span class="ruby-identifier">module_eval</span>(<span class="ruby-node">&quot;def #{name_}(*params_, &amp;block_); val_ = ::Blockenspiel._target_dispatch(self, :#{name_}, params_, block_); ::Blockenspiel::NO_VALUE.equal?(val_) ? super(*params_, &amp;block_) : val_; end\n&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dsl_methods" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dsl_methods</span><span
            class="method-args">(*names_)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Control the behavior of methods with respect to parameterless blocks, or
make a list of methods available to parameterless blocks in bulk.</p>

<p>To enable automatic exporting of methods to parameterless blocks. After
executing this command, all public methods defined in the class will be
available on parameterless blocks, until <code>dsl_methods false</code> is
called:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_methods</span> <span class="ruby-keyword">true</span>
</pre>

<p>To disable automatic exporting of methods to parameterless blocks. After
executing this command, methods defined in this class will be excluded from
parameterless blocks, until <code>dsl_methods true</code> is called:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_methods</span> <span class="ruby-keyword">false</span>
</pre>

<p>To make a list of methods available to parameterless blocks in bulk:</p>

<pre>dsl_methods :my_method1, :my_method2, ...</pre>

<p>You can also point dsl methods to a method of a different name on the
target class, by using a hash syntax, as follows:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_methods</span> :<span class="ruby-identifier">my_method1</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">target_class_method1</span>,
            :<span class="ruby-identifier">my_method2</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">target_class_method2</span>
</pre>

<p>You can mix non-renamed and renamed method declarations as long as the
renamed (hash) methods are at the end. e.g.:</p>

<pre class="ruby"><span class="ruby-identifier">dsl_methods</span> :<span class="ruby-identifier">my_method1</span>, :<span class="ruby-identifier">my_method2</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">target_class_method2</span>
</pre>
          
          

          
          <div class="method-source-code" id="dsl_methods-source">
            <pre><span class="ruby-comment"># File lib/blockenspiel/dsl_setup.rb, line 216</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dsl_methods</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names_</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">names_</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">names_</span> <span class="ruby-operator">==</span> [<span class="ruby-keyword">true</span>]
    <span class="ruby-ivar">@_blockenspiel_active</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">names_</span> <span class="ruby-operator">==</span> [<span class="ruby-keyword">false</span>]
    <span class="ruby-ivar">@_blockenspiel_active</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">names_</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">names_</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name_</span>, <span class="ruby-identifier">delegate_</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">dsl_method</span>(<span class="ruby-identifier">name_</span>, <span class="ruby-identifier">delegate_</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">names_</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name_</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">dsl_method</span>(<span class="ruby-identifier">name_</span>, <span class="ruby-identifier">name_</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

